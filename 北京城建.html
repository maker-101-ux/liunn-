<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>北京城市发展全景可视化</title>
    <!-- 引入 ECharts 库 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script> -->
    <script src="echarts.js"></script>
    <link rel="stylesheet" href="./css/跟踪导航栏.css">
    <link rel="stylesheet" href="./css/css.css">
    <style>
        /* 基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", Arial, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            padding: 20px;
            line-height: 1.6;
        }

        /* 头部样式 */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #fff;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .header-title {
            font-size: 24px;
            font-weight: bold;
            color: #2E2733;
            margin-bottom: 10px;
        }

        .header-controls {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
        }

        select {
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #fff;
            color: #333;
            cursor: pointer;
        }

        /* 内容网格布局 */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* 卡片通用样式 */
        .dashboard-card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: #2E2733;
        }

        .card-actions {
            color: #999;
            font-size: 14px;
        }

        /* 旭日图容器 */
        #sunburst-container {
            grid-column: 1 / 3;
            height: 800px;

        }

        #main {
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }

        /* 概览统计 */
        .overview-stats {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }

        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background-color: #FF7853;
        }

        .stat-value {
            font-size: 22px;
            font-weight: bold;
            color: #2E2733;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }

        /* 图表区域 */
        .card-section {
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 16px;
            background-color: #FF7853;
            margin-right: 8px;
            border-radius: 2px;
        }

        .chart-container {
            width: 100%;
            height: 280px;
            border-radius: 6px;
            background-color: #f8f9fa;
            padding: 10px;
            overflow: hidden;
        }

        .distribution-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* 人口相关配套 */
        .demographics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .demographic-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .demographic-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .demographic-label {
            font-size: 12px;
            color: #999;
            text-align: center;
        }

        /* 满意度调研 */
        .survey-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            gap: 10px;
        }

        .survey-header {
            font-weight: 600;
            color: #333;
            padding: 8px 0;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .survey-category {
            padding: 8px 0;
            color: #333;
            border-bottom: 1px solid #eee;
        }

        .survey-score {
            height: 60px;
            border-bottom: 1px solid #eee;
        }

        /* 近期动态 */
        .recent-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .recent-filter select {
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .recent-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .recent-item {
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            transition: background-color 0.3s ease;
        }

        .recent-item:hover {
            background-color: #f0f2f5;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #666;
        }

        .item-details {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .item-metrics {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            font-size: 12px;
            color: #666;
        }

        .metric-value {
            font-weight: 600;
            color: #2E2733;
        }

        /* 响应式设计 */
        @media (max-width: 1200px) {
            .content-grid {
                grid-template-columns: 1fr;
            }

            #sunburst-container {
                grid-column: 1 / 2;
                height: 600px;
            }
        }

        @media (max-width: 768px) {

            .demographics-grid,
            .distribution-grid,
            .survey-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .overview-stats {
                flex-direction: column;
            }

            .chart-container {
                height: 250px;
                /* 小屏幕下进一步减小图表高度 */
            }

            #sunburst-container {
                height: 500px;
            }
        }
        /* 过度动画 */
        .title {
            font-family: sans-serif;
            font-size: 10rem;
            color: #17f700;
            font-weight: 900;
            cursor: pointer;
        }

        .title span {
            font-size: 10rem;
            color: #f7f7f7;
        }

        .ceshi {
            float: right;
        }
    </style>
</head>

<body>
<!-- 过度动画 -->
    <div class="loading">
        <svg viewbox='0 0 50 50'>
            <circle r='25' cx='25' cy='25'></circle>
        </svg>
        <p>LOADING</p>
    </div>
    <!-- <p onclick="loading.in('./page2.html')" class="title">dasd </p> -->
    <!-- 在 <body> 内任意位置添加测试按钮 -->



    <script>
        // JIEJOE produce
        // b站主页：https://space.bilibili.com/3546390319860710
        const loading = {
            container: document.querySelector(".loading"),
            in(target) {
                this.container.classList.remove("loading_out");
                setTimeout(() => {
                    window.location.href = target;
                }, 1000)
            },
            out() {
                this.container.classList.add("loading_out");
            }
        };
        window.addEventListener("load", () => {
            loading.out();
        })
    </script>

<!-- 过度动画 -->


    <!-- 头部区域 -->
    <div class="header">
        <div class="header-title">北京城市发展全景可视化</div>
        <div class="header-controls">
            <div class="filter-group">
                <span class="filter-label">数据周期:</span>
                <select class="date-range">
                    <option>2023年1月 - 2023年12月</option>
                    <option>2022年1月 - 2022年12月</option>
                    <option>近6个月</option>
                    <option>自定义</option>
                </select>
            </div>
            <div class="filter-group">
                <span class="filter-label">显示方式:</span>
                <select class="view-mode">
                    <option>综合视图</option>
                    <option>数据视图</option>
                    <option>图表视图</option>
                </select>
            </div>
        </div>
    </div>

    <!-- 主要内容区域 -->
    <div class="content-grid">
        <!-- 1. 北京建制划分旭日图（跨两列） -->
        <div class="dashboard-card" id="sunburst-container">
            <!-- <div class="card-header">
                <div class="card-title">北京历史建制划分</div>
                <div class="card-actions">
                    <span>点击层级查看详情 | 可缩放交互</span>
                </div>
            </div> -->
            <div id="main"></div>
        </div>

        <!-- 2. 北京城建概览卡片 -->
        <div class="dashboard-card">
            <div class="card-header">
                <div class="card-title">城建数据概览</div>
                <div class="card-actions">

                </div>
            </div>

            <!-- 统计数据 -->
            <!-- <div class="overview-stats">
                <div class="stat-item">
                    <div class="stat-value">128.5万㎡</div>
                    <div class="stat-label">年度竣工面积</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">326</div>
                    <div class="stat-label">在建项目数量</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">86.7%</div>
                    <div class="stat-label">项目按时完成率</div>
                </div>
            </div> -->

            <!-- 区域分布图表 -->
            <div class="card-section">
                <h3 class="section-title">区域分布</h3>
                <div class="chart-container" id="region-chart"></div>
            </div>

            <!-- 项目类型分布 -->
            <div class="card-section">
                <h3 class="section-title">建制沿革变化</h3>
                <div class="distribution-grid">
                    <div class="chart-container" id="project-type-chart"></div>
                    <div class="chart-container" id="top-projects"></div>
                </div>
            </div>

            <!-- 建设趋势 -->
            <div class="card-section">
                <h3 class="section-title">交通发展</h3>
                <div class="chart-container" id="trend-chart"></div>
            </div>
        </div>

        <!-- 3. 人口相关城建配套卡片 -->
        <div class="dashboard-card">
            <div class="card-header">
                <div class="card-title">城建配套</div>
                <div class="card-actions">
                    <span>点击数据点查看详情</span>
                </div>
            </div>

            <div class="demographics-grid">
                <!-- 性别友好设施覆盖 -->
                <div class="demographic-item">
                    <h3 class="demographic-title">建筑类型及分布</h3>
                    <div class="chart-container" id="gender-facility-chart"></div>
                    <div class="demographic-label">覆盖率对比</div>
                </div>

                <!-- 各年龄段配套设施 -->
                <div class="demographic-item">
                    <h3 class="demographic-title">建筑分布</h3>
                    <div class="chart-container" id="age-facility-chart"></div>
                    <div class="demographic-label">设施数量分布</div>
                </div>
            </div>

            <!-- 教育配套建设 -->
            <div class="card-section">
                <h3 class="section-title">自然环境</h3>
                <div class="chart-container" id="education-facility-chart"></div>
            </div>

            <!-- 交通配套建设 -->
            <div class="card-section">
                <h3 class="section-title">人口及相关配套设施</h3>
                <div class="chart-container" id="transportation-chart"></div>
            </div>

            <!-- 医疗配套建设 -->
            <div class="card-section">
                <h3 class="section-title">重点建筑</h3>
                <div class="chart-container" id="medical-chart"></div>
            </div>
        </div>

        <!-- 4. 城建满意度调研卡片 -->


        <!-- 5. 近期城建动态卡片 -->

    </div>

<!-- 底边导航栏 -->
<div class="bor">
        <div class="nav1">
            <ul>
                <li><a onclick="loading.in('./index.html')" style="cursor: pointer;">首页</a></li>
                <li><a onclick="loading.in('./北京城建.html')" style="cursor: pointer;">城市建设</a></li>
                <li><a onclick="loading.in('./社会人文.html')" style="cursor: pointer;">社会人文</a></li>
                <li><a onclick="loading.in('./自然环境.html')" style="cursor: pointer;">自然环境</a></li>
                <li><a href="#">敬请期待</a></li>
                <li><a href="#">敬请期待</a></li>
                <div class="nav-box"></div>
            </ul>
        </div>
    </div>
<!-- 底边导航栏 -->

    <script>
        const header = document.querySelector('header');
        const img = document.querySelector('.img');
        let scrollDistance = 0;
        let requestId = null;
        function updateHeaderClipPath() {
            const clipPathValue = `polygon(0 0, 100% 0%, 100% ${(scrollDistance <= 600) ? 100 - ((scrollDistance / 600) * 60) : 75}%, 0 100%)`;
            header.style.clipPath = clipPathValue;
            const scaleValue = 1 + ((scrollDistance / 600) * 1);
            img.style.transform = `scale(${scaleValue})`;
            const opacityValue = (scrollDistance / 600);
        }
        function scrollHandler(event) {
            if (event.deltaY < 0) {
                scrollDistance = Math.max(0, scrollDistance + event.deltaY);
            } else {
                scrollDistance = Math.min(600, scrollDistance + event.deltaY);
            }
            if (!requestId) {
                requestId = window.requestAnimationFrame(() => {
                    updateHeaderClipPath();
                    requestId = null;
                });
            }
        }
        window.addEventListener('wheel', scrollHandler);
    </script>

    <script>
        // 初始化所有图表
        function initCharts() {
            // 初始化旭日图
            initSunburstChart();

            // 初始化其他图表
            initRegionChart();
            initProjectTypeChart();
            initTopProjectsChart();
            initTrendChart();
            initGenderFacilityChart();
            initAgeFacilityChart();
            initEducationFacilityChart();
            initTransportationChart();
            initMedicalChart();
            initSurveyCharts();

            // 响应窗口大小变化
            window.addEventListener('resize', function () {
                Object.values(charts).forEach(chart => {
                    chart.resize();
                });
            });
        }

        // 存储所有图表实例
        const charts = {};

        // 1. 初始化旭日图
        function initSunburstChart() {
            const chartDom = document.getElementById('main');
            charts.sunburst = echarts.init(chartDom);

            // 颜色配置
            const colors = ['#FFAE57', '#FF7853', '#EA5151', '#CC3F57', '#FFAE57'];
            const bgColor = '#2E2733';
            const itemStyle = {
                period1: { color: colors[0] },
                period2: { color: colors[1] },
                period3: { color: colors[2] },
                period4: { color: colors[3] }
            };

            // 数据结构
            const data = {
                name: '北京建制划分',
                itemStyle: { color: colors[1] },
                children: [
                    {
                        name: '上古三代时期',
                        itemStyle: itemStyle.period1,
                        children: [
                            {
                                name: '九州划分',
                                value: 1,
                                children: [{
                                    name: '幽州',
                                    value: 1,
                                    description: '部分记载中"幽州"指包括今北京在内的河北北部地区'
                                }]
                            }
                        ]
                    },
                    {
                        name: '西周初年',
                        itemStyle: itemStyle.period2,
                        children: [
                            {
                                name: '诸侯国',
                                value: 1,
                                children: [{
                                    name: '蓟和燕',
                                    value: 1,
                                    description: '今北京地区最早的建置'
                                }]
                            }
                        ]
                    },
                    {
                        name: '春秋战国',
                        itemStyle: itemStyle.period3,
                        children: [
                            {
                                name: '燕国属地',
                                value: 1,
                                children: [{
                                    name: '郡县制',
                                    value: 1,
                                    description: '开始在边远地区设郡、县'
                                }]
                            }
                        ]
                    },
                    {
                        name: '秦汉时期',
                        itemStyle: itemStyle.period4,
                        children: [
                            {
                                name: '行政区划',
                                value: 1,
                                children: [{
                                    name: '广阳郡/幽州',
                                    value: 1,
                                    description: '秦属广阳郡；汉属幽州管辖'
                                }]
                            }
                        ]
                    },
                    {
                        name: '魏时期',
                        itemStyle: itemStyle.period1,
                        children: [
                            {
                                name: '建制变化',
                                value: 1,
                                children: [{
                                    name: '幽州并入冀州',
                                    value: 1,
                                    description: '建安十八年省幽州，原属幽州诸郡归冀州'
                                }]
                            }
                        ]
                    },
                    {
                        name: '辽代',
                        itemStyle: itemStyle.period2,
                        children: [
                            {
                                name: '陪都设置',
                                value: 1,
                                children: [{
                                    name: '南京（燕京）',
                                    value: 1,
                                    description: '天会元年升幽州为南京，号燕京，建为陪都'
                                }]
                            }
                        ]
                    },
                    {
                        name: '金代',
                        itemStyle: itemStyle.period3,
                        children: [
                            {
                                name: '国都设置',
                                value: 1,
                                children: [{
                                    name: '中都',
                                    value: 1,
                                    description: '贞元元年改燕京为中都，定为国都'
                                }]
                            }
                        ]
                    },
                    {
                        name: '元代',
                        itemStyle: itemStyle.period4,
                        children: [
                            {
                                name: '行政中心',
                                value: 1,
                                children: [{
                                    name: '大都城',
                                    value: 1,
                                    description: '设中书省、尚书省、御史台衙署等'
                                }]
                            }
                        ]
                    },
                    {
                        name: '明代',
                        itemStyle: itemStyle.period1,
                        children: [
                            {
                                name: '名称变迁',
                                value: 1,
                                children: [{
                                    name: '北平→北京',
                                    value: 1,
                                    description: '朱元璋时期称北平府，永乐元年改北平为北京'
                                }]
                            }
                        ]
                    },
                    {
                        name: '清代',
                        itemStyle: itemStyle.period2,
                        children: [
                            {
                                name: '京师设置',
                                value: 1,
                                children: [{
                                    name: '京师顺天府',
                                    value: 1,
                                    description: '有特殊行政体系，设步军统领衙门等'
                                }]
                            }
                        ]
                    },
                    {
                        name: '民国时期',
                        itemStyle: itemStyle.period3,
                        children: [
                            {
                                name: '名称变化',
                                value: 1,
                                children: [{
                                    name: '北京→北平',
                                    value: 1,
                                    description: '1928年改为北平特别市，为院辖市'
                                }]
                            }
                        ]
                    },
                    {
                        name: '新中国成立后',
                        itemStyle: itemStyle.period4,
                        children: [
                            {
                                name: '首都确立',
                                value: 1,
                                children: [{
                                    name: '北京',
                                    value: 1,
                                    description: '1949年9月27日，定为首都'
                                }]
                            }
                        ]
                    }
                ]
            };

            // 配置旭日图
            const option = {
                backgroundColor: bgColor,
                color: colors,
                tooltip: {
                    formatter: function (params) {
                        return `<strong>${params.name}</strong><br/>${params.data.description || ''}`;
                    }
                },
                series: [
                    {
                        type: 'sunburst',
                        center: ['50%', '50%'],
                        radius: ['10%', '90%'],
                        data: [data],
                        sort: null,
                        label: {
                            color: '#fff',
                            fontSize: 12,
                            overflow: 'truncate',
                            ellipsis: '...'
                        },
                        itemStyle: {
                            borderColor: bgColor,
                            borderWidth: 2
                        },
                        levels: [
                            {
                                // 最内层
                                r0: 0,
                                r: 70,
                                label: {
                                    fontSize: 16,
                                    rotate: 0,
                                    position: 'center'
                                }
                            },
                            {
                                // 第二层（历史时期）
                                r0: 70,
                                r: 130,
                                label: {
                                    fontSize: 13,
                                    rotate: 0,
                                    position: 'inside',
                                    horizontalAlign: 'middle',
                                    verticalAlign: 'middle'
                                }
                            },
                            {
                                // 第三层
                                r0: 130,
                                r: 210,
                                label: {
                                    fontSize: 12,
                                    rotate: function (params) {
                                        const angle = (params.startAngle + params.endAngle) / 2;
                                        return angle > 90 && angle < 270 ? angle + 180 : angle;
                                    },
                                    position: 'middle',
                                    align: 'center'
                                }
                            },
                            {
                                // 最外层
                                r0: 210,
                                r: '90%',
                                label: {
                                    fontSize: 10,
                                    rotate: 0,
                                    distance: 20,
                                    align: 'left'
                                }
                            }
                        ]
                    }
                ]
            };

            charts.sunburst.setOption(option);
        }

        // 2. 初始化区域分布图表
        function initRegionChart() {
            const chartDom = document.getElementById('region-chart');
            charts.region = echarts.init(chartDom);

            const option = {
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    top: '5%',
                    left: 'center'
                },
                series: [
                    {
                        name: '项目数量',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#fff',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: 16,
                                fontWeight: 'bold'
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: [
                            { value: 86, name: '朝阳区' },
                            { value: 65, name: '海淀区' },
                            { value: 42, name: '丰台区' },
                            { value: 38, name: '西城区' },
                            { value: 32, name: '东城区' },
                            { value: 63, name: '其他区域' }
                        ]
                    }
                ]
            };

            charts.region.setOption(option);
        }

        // 3. 初始化项目类型图表
        function initProjectTypeChart() {
            const chartDom = document.getElementById('project-type-chart');
            charts.projectType = echarts.init(chartDom);


            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' },
                    formatter: function (params) {
                        const item = params[0];
                        const details = {
                            '西周': '燕国都城，称"蓟"，是北京最早的城市雏形',
                            '秦汉': '设广阳郡，管辖蓟城及周边地区',
                            '隋唐': '为幽州治所，北方军事重镇',
                            '辽金': '辽为南京，金升为中都，首次成为王朝都城',
                            '元代': '定名"大都"，成为全国政治中心',
                            '明代': '初为北平府，后迁都定名"京师"，设顺天府',
                            '清代': '沿用京师称号，顺天府管辖范围扩大',
                            '民国': '1928年改称"北平市"，为特别市',
                            '新中国': '1949年定为首都，称"北京市"，中央直辖市'
                        };
                        return `${item.name}<br/>
                    建制名称：${item.data.name}<br/>
                    管辖范围：${item.data.value} 个县域（含近似辖区）<br/>
                    说明：${details[item.name]}`;
                    }
                },
                title: {
                    text: '北京建制沿革关键节点',
                    left: 'center',
                    textStyle: { fontSize: 14 },
                    top: 5 // 标题上移，节省空间
                },
                grid: {
                    left: '15%',
                    right: '8%',
                    bottom: '15%', // 关键：增加底部留白，避免X轴名称被遮挡
                    top: '12%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    name: '管辖县域数量（含近似辖区）',
                    nameTextStyle: {
                        fontSize: 12,
                        padding: [10, 0, 0, 0] // 名称向下偏移，远离轴线
                    },
                    nameLocation: 'middle', // 名称居中显示
                    nameGap: 30, // 名称与轴线的距离加大
                    axisLabel: { fontSize: 10 }
                },
                yAxis: {
                    type: 'category',
                    data: ['西周', '秦汉', '隋唐', '辽金', '元代', '明代', '清代', '民国', '新中国'],
                    axisLabel: { fontSize: 12, interval: 0 }
                },
                series: [
                    {
                        name: '建制信息',
                        type: 'bar',
                        data: [
                            { name: '蓟城', level: '诸侯国都城', value: 3 },
                            { name: '广阳郡', level: '郡级', value: 8 },
                            { name: '幽州', level: '州级', value: 12 },
                            { name: '中都', level: '王朝都城', value: 15 },
                            { name: '大都', level: '全国首都', value: 20 },
                            { name: '京师', level: '全国首都', value: 22 },
                            { name: '顺天府', level: '首都辖区', value: 25 },
                            { name: '北平市', level: '特别市', value: 18 },
                            { name: '北京市', level: '直辖市', value: 16 }
                        ],
                        label: {
                            show: true,
                            position: 'right',
                            formatter: '{c}',
                            fontSize: 10
                        },
                        itemStyle: {
                            color: function (params) {
                                const isCapital = ['诸侯国都城', '王朝都城', '全国首都', '首都辖区'].includes(params.data.level);
                                return isCapital ? '#E53935' : '#1E88E5';
                            }
                        }
                    }
                ]
            };

            charts.projectType.setOption(option);
        }

        // 4. 初始化重点项目图表
        function initTopProjectsChart() {
            const chartDom = document.getElementById('top-projects');
            charts.topProjects = echarts.init(chartDom);



            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a}<br/>{b}: {c}年 ({d}%)'
                },
                title: {
                    text: '北京建制沿革阶段占比',
                    left: 'right',
                    top: -1,
                    textStyle: { fontSize: 14 }
                },
                legend: {
                    orient: 'horizontal',
                    bottom: 10,
                    left: 'center',
                    data: ['诸侯国都城', '地方行政单位', '王朝都城', '现代直辖市'],
                    itemWidth: 12,
                    itemHeight: 12,
                    textStyle: { fontSize: 10 }
                },
                series: [
                    {
                        name: '建制时期',
                        type: 'pie',
                        radius: '60%',
                        center: ['50%', '40%'],
                        data: [
                            {
                                value: 822,
                                name: '诸侯国都城',
                                itemStyle: { color: '#CD5C5C' },
                                label: {
                                    formatter: '{b}\n{d}%',
                                    fontSize: 10
                                }
                            },
                            {
                                value: 1187,
                                name: '地方行政单位',
                                itemStyle: { color: '#4682B4' },
                                label: {
                                    formatter: '{b}\n{d}%',
                                    fontSize: 10
                                }
                            },
                            {
                                value: 747,
                                name: '王朝都城',
                                itemStyle: { color: '#DAA520' },
                                label: {
                                    formatter: '{b}\n{d}%',
                                    fontSize: 10
                                }
                            },
                            {
                                value: 114,
                                name: '现代直辖市',
                                itemStyle: { color: '#20B2AA' },
                                label: {
                                    formatter: '{b}\n{d}%',
                                    fontSize: 10
                                }
                            }
                        ],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                ]
            };

            charts.topProjects.setOption(option);
        }

        // 5. 初始化建设趋势图表
        function initTrendChart() {
            const chartDom = document.getElementById('trend-chart');
            charts.trend = echarts.init(chartDom);

            // const option = {
            //     tooltip: {
            //         trigger: 'axis'
            //     },
            //     legend: {
            //         data: ['竣工面积(万㎡)', '新开项目数']
            //     },
            //     grid: {
            //         left: '3%',
            //         right: '4%',
            //         bottom: '3%',
            //         containLabel: true
            //     },
            //     xAxis: {
            //         type: 'category',
            //         boundaryGap: false,
            //         data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月']
            //     },
            //     yAxis: {
            //         type: 'value'
            //     },
            //     series: [
            //         {
            //             name: '竣工面积(万㎡)',
            //             type: 'line',
            //             stack: 'Total',
            //             data: [8.5, 7.2, 10.8, 12.3, 15.6, 14.2, 16.8, 18.5, 12.4, 9.8, 7.5, 5.9],
            //             lineStyle: {
            //                 width: 3
            //             },
            //             symbol: 'circle',
            //             symbolSize: 8
            //         },
            //         {
            //             name: '新开项目数',
            //             type: 'line',
            //             stack: 'Total',
            //             data: [12, 8, 15, 22, 28, 32, 26, 24, 18, 15, 10, 8],
            //             lineStyle: {
            //                 width: 3
            //             },
            //             symbol: 'circle',
            //             symbolSize: 8
            //         }
            //     ]
            // };

            const option = {
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    type: 'scroll', // 开启滚动，当图例过多时可滚动查看
                    orient: 'horizontal',
                    left: 'center',
                    top: '10%',
                    itemWidth: 12,
                    itemHeight: 12,
                    textStyle: {
                        fontSize: 10
                    }
                },
                grid: {
                    left: '5%',
                    right: '5%',
                    top: '18%',
                    bottom: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: ['1950年', '1970年', '1990年', '2000年', '2010年', '2020年', '2025年(预计)'],
                    axisLabel: {
                        fontSize: 10
                    }
                },
                yAxis: {
                    type: 'value',
                    name: '长度(公里)',
                    axisLabel: {
                        fontSize: 10
                    }
                },
                series: [
                    {
                        name: '朝阳道路里程',
                        type: 'line',
                        data: [85, 210, 480, 720, 980, 1250, 1320],
                        lineStyle: {
                            width: 2
                        },
                        symbol: 'circle',
                        symbolSize: 6
                    },
                    {
                        name: '海淀道路里程',
                        type: 'line',
                        data: [70, 180, 420, 650, 890, 1120, 1180],
                        lineStyle: {
                            width: 2
                        },
                        symbol: 'circle',
                        symbolSize: 6
                    },
                    {
                        name: '通州道路里程',
                        type: 'line',
                        data: [40, 90, 180, 320, 580, 950, 1150],
                        lineStyle: {
                            width: 2
                        },
                        symbol: 'circle',
                        symbolSize: 6
                    },
                    {
                        name: '朝阳轨道长度',
                        type: 'line',
                        data: [0, 15, 45, 80, 120, 180, 210],
                        lineStyle: {
                            width: 2,
                            type: 'dashed'
                        },
                        symbol: 'square',
                        symbolSize: 6
                    },
                    {
                        name: '海淀轨道长度',
                        type: 'line',
                        data: [0, 10, 40, 75, 110, 160, 190],
                        lineStyle: {
                            width: 2,
                            type: 'dashed'
                        },
                        symbol: 'square',
                        symbolSize: 6
                    },
                    {
                        name: '通州轨道长度',
                        type: 'line',
                        data: [0, 5, 10, 25, 60, 110, 170],
                        lineStyle: {
                            width: 2,
                            type: 'dashed'
                        },
                        symbol: 'square',
                        symbolSize: 6
                    }
                ]
            };


            charts.trend.setOption(option);
        }






        // 6. 初始化性别友好设施图表
        function initGenderFacilityChart() {
            const chartDom = document.getElementById('gender-facility-chart');
            charts.genderFacility = echarts.init(chartDom);


            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' },
                    formatter: function (params) {
                        let res = `${params[0].name}<br/>`;
                        params.forEach(item => {
                            res += `${item.marker} ${item.seriesName}：${item.value} 处<br/>`;
                        });
                        return res;
                    }
                },
                title: {
                    text: '北京建筑类型变化',
                    left: 'center',
                    textStyle: { fontSize: 14 }
                },
                legend: {
                    type: 'scroll',
                    bottom: 0,
                    data: [
                        { name: '皇家建筑', icon: 'rect', textStyle: { color: '#DAA520' } },
                        { name: '民居建筑', icon: 'rect', textStyle: { color: '#CD853F' } },
                        { name: '现代建筑', icon: 'rect', textStyle: { color: '#87CEFA' } }
                    ],
                    formatter: '{name}',
                    colorDesc: {
                        '皇家建筑': '金/皇权',
                        '民居建筑': '棕/传统',
                        '现代建筑': '蓝/现代'
                    }
                },
                grid: {
                    left: '2%',
                    right: '2%',
                    bottom: '12%',
                    top: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['元代', '明代', '清代', '民国', '现代', '当代'],
                    axisLabel: { fontSize: 10, rotate: 10 }
                },
                yAxis: {
                    type: 'value',
                    name: '数量',
                    nameTextStyle: { fontSize: 12 },
                    axisLabel: { fontSize: 10 }
                },
                series: [
                    {
                        name: '皇家建筑',
                        type: 'bar',
                        data: [38, 65, 82, 78, 75, 70],
                        itemStyle: { color: '#DAA520' }
                    },
                    {
                        name: '民居建筑',
                        type: 'bar',
                        data: [120, 180, 210, 190, 150, 90],
                        itemStyle: { color: '#CD853F' }
                    },
                    {
                        name: '现代建筑',
                        type: 'bar',
                        data: [0, 0, 0, 30, 120, 280],
                        itemStyle: { color: '#87CEFA' }
                    }
                ]
            };

            charts.genderFacility.setOption(option);
        }

        // 7. 初始化年龄段配套设施图表
        function initAgeFacilityChart() {
            const chartDom = document.getElementById('age-facility-chart');
            charts.ageFacility = echarts.init(chartDom);

            // const option = {
            //     tooltip: {
            //         trigger: 'item'
            //     },
            //     legend: {
            //         top: '5%',
            //         left: 'center'
            //     },
            //     series: [
            //         {
            //             name: '设施数量',
            //             type: 'pie',
            //             radius: ['40%', '70%'],
            //             avoidLabelOverlap: false,
            //             itemStyle: {
            //                 borderRadius: 10,
            //                 borderColor: '#fff',
            //                 borderWidth: 2
            //             },
            //             label: {
            //                 show: false,
            //                 position: 'center'
            //             },
            //             emphasis: {
            //                 label: {
            //                     show: true,
            //                     fontSize: 16,
            //                     fontWeight: 'bold'
            //                 }
            //             },
            //             labelLine: {
            //                 show: false
            //             },
            //             data: [
            //                 { value: 42, name: '儿童设施' },
            //                 { value: 58, name: '青少年设施' },
            //                 { value: 75, name: '成人设施' },
            //                 { value: 63, name: '老年设施' }
            //             ]
            //         }
            //     ]
            // };

            const option = {
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    top: '5%',
                    left: 'center'
                },
                series: [
                    {
                        name: '北京重点建筑数量',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#fff',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: 16,
                                fontWeight: 'bold'
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: [
                            { value: 38, name: '历史古迹' },
                            { value: 52, name: '现代地标' },
                            { value: 29, name: '文化场馆' },
                            { value: 45, name: '商业建筑' },
                            { value: 31, name: '行政建筑' }
                        ]
                    }
                ]
            };



            charts.ageFacility.setOption(option);
        }

        // 8. 初始化教育配套建设图表
        function initEducationFacilityChart() {
            const chartDom = document.getElementById('education-facility-chart');
            charts.educationFacility = echarts.init(chartDom);

            // const option = {
            //     tooltip: {
            //         trigger: 'axis',
            //         axisPointer: {
            //             type: 'shadow'
            //         }
            //     },
            //     legend: {
            //         data: ['幼儿园', '小学', '中学', '大学']
            //     },
            //     grid: {
            //         left: '3%',
            //         right: '4%',
            //         bottom: '3%',
            //         containLabel: true
            //     },
            //     xAxis: {
            //         type: 'value'
            //     },
            //     yAxis: {
            //         type: 'category',
            //         data: ['东城区', '西城区', '朝阳区', '海淀区', '丰台区', '其他区域']
            //     },
            //     series: [
            //         {
            //             name: '幼儿园',
            //             type: 'bar',
            //             stack: 'total',
            //             emphasis: {
            //                 focus: 'series'
            //             },
            //             data: [28, 32, 65, 58, 42, 95]
            //         },
            //         {
            //             name: '小学',
            //             type: 'bar',
            //             stack: 'total',
            //             emphasis: {
            //                 focus: 'series'
            //             },
            //             data: [15, 18, 32, 36, 25, 58]
            //         },
            //         {
            //             name: '中学',
            //             type: 'bar',
            //             stack: 'total',
            //             emphasis: {
            //                 focus: 'series'
            //             },
            //             data: [10, 12, 22, 28, 18, 42]
            //         },
            //         {
            //             name: '大学',
            //             type: 'bar',
            //             stack: 'total',
            //             emphasis: {
            //                 focus: 'series'
            //             },
            //             data: [3, 2, 5, 18, 2, 15]
            //         }
            //     ]
            // };
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['森林覆盖', '水域面积', '湿地面积', '荒漠面积'],
                    right: '10%',
                    top: '5%',
                    orient: 'horizontal'
                },
                grid: {
                    left: '12%',
                    right: '10%',
                    bottom: '8%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    name: '占比(%)',
                    nameLocation: 'middle',
                    nameGap: 30,
                    axisLabel: {
                        formatter: '{value}'
                    }
                },
                yAxis: {
                    type: 'category',
                    data: ['远古时期', '唐宋时期', '1980年', '民国时期', '新中国成立', '改革开放', '2024年'],
                    axisLabel: {
                        interval: 0,
                        fontSize: 12
                    }
                },
                series: [
                    {
                        name: '森林覆盖',
                        type: 'bar',
                        stack: 'total',
                        emphasis: { focus: 'series' },
                        data: [75, 62, 16.6, 32, 1.3, 38, 44.95],
                        itemStyle: { color: '#4895ef' }
                    },
                    {
                        name: '水域面积',
                        type: 'bar',
                        stack: 'total',
                        emphasis: { focus: 'series' },
                        data: [50, 18, 15.28, 10, 8, 12, 3.6],
                        itemStyle: { color: '#a2d9ce' }
                    },
                    {
                        name: '湿地面积',
                        type: 'bar',
                        stack: 'total',
                        emphasis: { focus: 'series' },
                        data: [33, 10, 7, 5, 4, 6, 9],
                        itemStyle: { color: '#6b5b95' }
                    },
                    {
                        name: '荒漠面积',
                        type: 'bar',
                        stack: 'total',
                        emphasis: { focus: 'series' },
                        data: [2, 10, 30, 53, 63, 44, 5],
                        itemStyle: { color: '#f6bd60' }
                    }
                ]
            };

            charts.educationFacility.setOption(option);
        }

        // 9. 初始化交通配套建设图表
        function initTransportationChart() {
            const chartDom = document.getElementById('transportation-chart');
            charts.transportation = echarts.init(chartDom);

            // const option = {
            //     tooltip: {
            //         trigger: 'axis'
            //     },
            //     legend: {
            //         data: ['2020', '2021', '2022', '2023']
            //     },
            //     grid: {
            //         left: '3%',
            //         right: '4%',
            //         bottom: '3%',
            //         containLabel: true
            //     },
            //     xAxis: {
            //         type: 'category',
            //         boundaryGap: false,
            //         data: ['地铁线路', '公交路线', '共享单车点', '停车场', '充电桩']
            //     },
            //     yAxis: {
            //         type: 'value'
            //     },
            //     series: [
            //         {
            //             name: '2020',
            //             type: 'line',
            //             data: [23, 850, 3200, 1250, 8500]
            //         },
            //         {
            //             name: '2021',
            //             type: 'line',
            //             data: [24, 870, 3500, 1320, 12500]
            //         },
            //         {
            //             name: '2022',
            //             type: 'line',
            //             data: [27, 890, 3800, 1450, 18200]
            //         },
            //         {
            //             name: '2023',
            //             type: 'line',
            //             data: [30, 920, 4200, 1580, 25600]
            //         }
            //     ]
            // };

            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow' // 增加坐标轴指示器，方便定位数据点
                    }
                },
                legend: {
                    data: ['人口(万)', '文化场所(处)', '商贸市场(个)', '教育机构(所)'],
                    top: '10px', // 固定图例在顶部，避免与图表重叠
                    left: 'center', // 居中显示，节省横向空间
                    orient: 'horizontal',
                    itemWidth: 12, // 缩小图例图标
                    itemHeight: 12,
                    textStyle: { fontSize: 12 } // 减小图例文字
                },
                grid: {
                    left: '8%',   // 增大左侧间距
                    right: '8%',  // 增大右侧间距
                    bottom: '15%', // 增大底部间距（避免X轴标签重叠）
                    top: '15%',   // 预留图例空间
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: true, // 开启间距，避免数据点挤在边缘
                    data: ['唐代', '元代', '明代', '清代', '民国', '新中国初期', '改革开放', '21世纪以来'],
                    axisLabel: {
                        interval: 0,
                        rotate: 30, // 轻微旋转X轴标签，避免文字重叠
                        fontSize: 11 // 减小字体
                    }
                },
                yAxis: {
                    type: 'value',
                    name: '数量规模',
                    nameLocation: 'middle',
                    nameGap: 40,
                    nameTextStyle: { fontSize: 12 },
                    axisLabel: { fontSize: 11 }, // 减小Y轴文字
                    splitLine: { lineStyle: { type: 'dashed' } } // 虚线网格，减轻视觉压力
                },
                series: [
                    {
                        name: '人口(万)',
                        type: 'line',
                        smooth: true,
                        symbol: 'circle', // 显示数据点
                        symbolSize: 6, // 缩小数据点
                        lineStyle: { width: 2 }, // 线条加粗，增强区分度
                        data: [15, 40, 80, 120, 150, 200, 800, 2200]
                    },
                    {
                        name: '文化场所(处)',
                        type: 'line',
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: { width: 2 },
                        data: [20, 50, 120, 180, 300, 500, 1200, 3500]
                    },
                    {
                        name: '商贸市场(个)',
                        type: 'line',
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: { width: 2 },
                        data: [30, 80, 200, 350, 500, 800, 2000, 5000]
                    },
                    {
                        name: '教育机构(所)',
                        type: 'line',
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: { width: 2 },
                        data: [5, 15, 40, 100, 200, 350, 1500, 3800]
                    }
                ],
                // 自定义颜色，增强线条区分度
                color: ['#5470c6', '#91cc75', '#fac858', '#ee6666']
            };

            charts.transportation.setOption(option);
        }

        // 10. 初始化医疗配套建设图表
        function initMedicalChart() {
            const chartDom = document.getElementById('medical-chart');
            charts.medical = echarts.init(chartDom);

            // const option = {
            //     tooltip: {
            //         trigger: 'item'
            //     },
            //     series: [
            //         {
            //             name: '医疗资源分布',
            //             type: 'treemap',
            //             visibleMin: 300,
            //             label: {
            //                 show: true,
            //                 formatter: '{b}'
            //             },
            //             itemStyle: {
            //                 borderColor: '#fff'
            //             },
            //             levels: [
            //                 {
            //                     itemStyle: {
            //                         borderColor: '#fff',
            //                         borderWidth: 3
            //                     }
            //                 }
            //             ],
            //             data: [
            //                 {
            //                     name: '三级医院',
            //                     value: 78,
            //                     children: [
            //                         { name: '综合医院', value: 45 },
            //                         { name: '专科医院', value: 33 }
            //                     ]
            //                 },
            //                 {
            //                     name: '二级医院',
            //                     value: 156,
            //                     children: [
            //                         { name: '综合医院', value: 102 },
            //                         { name: '专科医院', value: 54 }
            //                     ]
            //                 },
            //                 {
            //                     name: '社区卫生服务中心',
            //                     value: 328
            //                 },
            //                 {
            //                     name: '诊所',
            //                     value: 1256
            //                 }
            //             ]
            //         }
            //     ]
            // };
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}<br>建造时期：{c}'
                },
                series: [
                    {
                        name: '北京重点建筑',
                        type: 'treemap',
                        visibleMin: 50,
                        label: {
                            show: true,
                            formatter: '{b}',
                            fontSize: 12
                        },
                        itemStyle: {
                            borderColor: '#fff',
                            borderWidth: 2
                        },
                        levels: [
                            {
                                itemStyle: {
                                    borderColor: '#fff',
                                    borderWidth: 3
                                }
                            }
                        ],
                        data: [
                            {
                                name: '古代建筑',
                                value: 300,
                                children: [
                                    { name: '故宫', value: 80, c: '明代' },
                                    { name: '天坛', value: 60, c: '明代' },
                                    { name: '颐和园', value: 70, c: '清代' },
                                    { name: '长城(北京段)', value: 90, c: '明代' }
                                ]
                            },
                            {
                                name: '近代建筑',
                                value: 200,
                                children: [
                                    { name: '北京饭店', value: 50, c: '民国' },
                                    { name: '协和医院主楼', value: 45, c: '民国' },
                                    { name: '北京大学红楼', value: 55, c: '清末' },
                                    { name: '前门火车站', value: 50, c: '清末' }
                                ]
                            },
                            {
                                name: '现代建筑',
                                value: 400,
                                children: [
                                    { name: '人民大会堂', value: 75, c: '20世纪50年代' },
                                    { name: '北京亚运会场馆', value: 65, c: '20世纪90年代' },
                                    { name: '国家体育场(鸟巢)', value: 90, c: '21世纪初' },
                                    { name: '中国尊', value: 85, c: '21世纪10年代' },
                                    { name: '国家大剧院', value: 85, c: '21世纪初' }
                                ]
                            }
                        ]
                    }
                ]
            };

            charts.medical.setOption(option);
        }

        // 11. 初始化满意度调研图表
        function initSurveyCharts() {
            // 满意度数据
            const surveyData = {
                traffic: [3.2, 3.5, 3.8, 4.1],
                environment: [3.5, 3.7, 3.9, 4.2],
                facility: [3.0, 3.3, 3.6, 3.9],
                education: [3.8, 3.9, 4.0, 4.2],
                medical: [3.3, 3.5, 3.7, 3.9]
            };

            // 年份
            const years = ['2020', '2021', '2022', '2023'];

            // 为每个满意度指标创建图表
            for (const [category, scores] of Object.entries(surveyData)) {
                for (let i = 0; i < scores.length; i++) {
                    const id = `${category}-${parseInt(years[i])}`;
                    const chartDom = document.getElementById(id);
                    if (chartDom) {
                        const chart = echarts.init(chartDom);
                        charts[id] = chart;

                        const option = {
                            series: [
                                {
                                    type: 'gauge',
                                    startAngle: 90,
                                    endAngle: -270,
                                    pointer: {
                                        show: false
                                    },
                                    progress: {
                                        show: true,
                                        overlap: false,
                                        roundCap: true,
                                        clip: false,
                                        itemStyle: {
                                            color: scores[i] >= 4 ? '#52c41a' : scores[i] >= 3.5 ? '#faad14' : '#f5222d'
                                        }
                                    },
                                    axisLine: {
                                        lineStyle: {
                                            width: 10
                                        }
                                    },
                                    splitLine: {
                                        show: false
                                    },
                                    axisTick: {
                                        show: false
                                    },
                                    axisLabel: {
                                        show: false
                                    },
                                    title: {
                                        show: false
                                    },
                                    detail: {
                                        valueAnimation: true,
                                        fontSize: 14,
                                        offsetCenter: [0, 0],
                                        formatter: '{value}',
                                        color: scores[i] >= 4 ? '#52c41a' : scores[i] >= 3.5 ? '#faad14' : '#f5222d'
                                    },
                                    data: [
                                        {
                                            value: scores[i]
                                        }
                                    ]
                                }
                            ]
                        };

                        chart.setOption(option);
                    }
                }
            }
        }
        

        // 页面加载完成后初始化图表
        window.addEventListener('load', initCharts);
    </script>
    <script src="./JS/跟踪导航栏.js"></script>
</body>

</html>